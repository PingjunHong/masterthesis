# Within-Label Variation in Natural Language Inference: A Linguistic Taxonomy for Explanations and Its Impact on Model Interpretation of Label Decisions

Repository for the materials associated with the Master Thesis **Within-Label Variation in Natural Language Inference: A Linguistic Taxonomy for Explanations and Its Impact on Model Interpretation of Label Decisions** at LMU Munich, June 2025.

## Thesis Goals and Contributions
This thesis aims to investigate the linguistic characteristics of explanations in Natural Language Inference (NLI) and their impact on model interpretation of label decisions. 

The key RQs are:
- **RQ1:** Can a linguistically grounded taxonomy capture and structure the diversity of human reasoning underlying the same NLI label?
- **RQ2:** Can the taxonomy improve the interpretability and alignment of explanations generated by large language models?
- **RQ3:** Is the taxonomy applicable across diverse NLI datasets with different explanation styles and annotation protocols?

Thesis Structure:
<p align="center">
  <img src="images/thesis_structure.png" alt="Thesis Structure" width="600"/>
</p>

## Content
### data
- e-SNLI: annotation results for e-SNLI
- LiveNLI: annotation results for LiveNLI
- VariErr: annotation results for VariErr

### llm_generator
```
├── llm_explanation
│   ├── Deepseek (generated explanations using ``deepseek-chat``)
│   │   ├── deepseek_classify_and_generate.zip
│   │   ├── deepseek_highlight_index.zip
│   │   ├── deepseek_highlight_marked.zip
│   │   ├── deepseek_label.zip
│   │   ├── deepseek_taxonomy_filtered.zip
│   ├── GPT4o (generated explanations using ``gpt4o``)
│   │   ├── gpt4o_classify_and_generate.zip
│   │   ├── gpt4o_highlight_index.zip
│   │   ├── gpt4o_highlight_marked.zip
│   │   ├── gpt4o_label.zip
│   │   ├── gpt4o_taxonomy_filtered.zip
│   ├── Llama (generated explanations using ``Llama-3.2-3B-Instruct``)   
│   │   ├── llama_classify_and_generate.zip
│   │   ├── llama_highlight_index.zip
│   │   ├── llama_highlight_marked.zip
│   │   ├── llama_label.zip
│   │   ├── llama_taxonomy_filtered.zip 
├── model_generator.py
```

### iaa
```
├── classification_iaa
│   ├── annotator0_iaa.jsonl (classification annotation of annotator 0)
│   ├── annotator1_iaa.jsonl (classification annotation of annotator 1)        
├── highlight_iaa
│   ├── annotator0_iaa_highlight.jsonl (highlight annotation of annotator 0)
│   ├── annotator1_iaa_highlight.jsonl (highlight annotation of annotator 1)
├── iaa.ipynb (iaa analysis)  
```

### Annotation Process
``/masterthesis/explanation_annotation.py``
The main annotation interface is designed using Streamlit (https://github.com/streamlit/streamlit)

To run the interactive web app, please follow the Quickstart instruction provided on Streamlit Guide (https://github.com/streamlit/streamlit).

Then, open a terminal and run:
```bash
$ streamlit run explation_annotation.py
```